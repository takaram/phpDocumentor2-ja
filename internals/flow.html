<!DOCTYPE html>

<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <title>Application Flow &mdash; phpDocumentor</title>

    <link rel="stylesheet" href="../_static/default.css" type="text/css"/>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css"/>
    <!--<link rel="stylesheet" href="../_static/configurationblock.css" type="text/css"/>-->

    <link href="../_static/css/template.css" rel="stylesheet" media="all">
    <style>
        h1 {
            font-family: serif;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            color: #333;
        }
        h2:first-of-type {
            margin-top: 25px;
        }
        h2 {
            font-family: serif;
            color: #333;
            border: none;
            font-style: italic;
            margin-top: 15px;
        }
        .well table.docutils {
            width: 100%;
        }
    </style>

    <script src="../_static/js/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="../_static/js/jquery-ui-1.8.2.custom.min.js" type="text/javascript"></script>
    <script src="../_static/js/bootstrap.js" type="text/javascript"></script>
    <script src="../_static/js/prettify/prettify.min.js" type="text/javascript"></script>
    <script type="text/javascript">

        function equalHeight(group) {
            var tallest = 0;

            group.each(function() {
                var thisHeight = $(this).height();
                if(thisHeight > tallest) {
                    tallest = thisHeight;
                }
            });

            group.height(tallest);
        }

        $(document).ready(function() {
            $('.contents .row').each(function() {
                equalHeight(jQuery(this).find('.well'));
            });

            // remove the classes added by Sphinx; the container class is
            // used in Twitter bootstrap and this collides
            $('.container .container').removeClass('container');
        });
    </script>

    <link rel="shortcut icon" href="http://demo.phpdoc.org/Responsive/img/favicon.ico">
    <link rel="apple-touch-icon" href="http://demo.phpdoc.org/Responsive/img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://demo.phpdoc.org/Responsive/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://demo.phpdoc.org/Responsive/img/apple-touch-icon-114x114.png">
        <link rel="top" title="phpDocumentor" href="../index.html"/>
        <link rel="up" title="Internals" href="index.html"/>
        <link rel="next" title="Tags" href="tags.html"/>
        <link rel="prev" title="Quality Assurance" href="qa.html"/> 
</head>
<body>

<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="/">phpDocumentor</a>

            <div class="nav-collapse">
                <ul class="nav">
                    <li class="dropdown">
                        <a href="#documentation" class="dropdown-toggle" data-toggle="dropdown"> Documentation<b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="/docs"><i class="icon-th"></i> phpDocumentor 2</a></li>
                            <li><a href="http://manual.phpdoc.org"><i class="icon-th"></i> phpDocumentor 1</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#demo" class="dropdown-toggle" data-toggle="dropdown"> Demo<b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="http://demo.phpdoc.org/Responsive/"><i class="icon-list-alt"></i> Responsive</a></li>
                        </ul>
                    </li>
                    <li><a href="/templates"><i class="icon-list-alt"></i> Templates</a></li>
                    <li><a href="/contact"><i class="icon-list-alt"></i> Contact</a></li>
                    <li><a href="/about"><i class="icon-list-alt"></i> About</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="go_to_top"><a href="#___" style="color: inherit">Back to top <i class="icon-upload icon-white"></i></a></div>
</div>
<div id="___" class="container">
    <noscript>
        <div class="alert alert-warning">
            Javascript is disabled; several features are only available if Javascript is enabled.
        </div>
    </noscript>

    <div class="row">
        <div class="span3">
        <h3><a href="../index.html">Table Of Contents</a>
        </h3>
        <ul>
<li><a class="reference internal" href="#">Application Flow</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#the-flow-in-more-detail">The flow in more detail</a><ul>
<li><a class="reference internal" href="#boot-the-application">Boot the Application</a></li>
<li><a class="reference internal" href="#parse-files-into-an-ast">Parse files into an AST</a><ul>
<li><a class="reference internal" href="#add-file-representation-to-project">Add File Representation to Project</a></li>
</ul>
</li>
<li><a class="reference internal" href="#transform-ast-into-artifacts">Transform AST into artifacts</a><ul>
<li><a class="reference internal" href="#transform-all-files">Transform all files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#link-fqsens-to-descriptors">Link FQSENs to Descriptors</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        <h4>Previous topic</h4>

        <p class="topless"><a href="qa.html"
                              title="previous chapter">Quality Assurance</a></p>
        <h4>Next topic</h4>

        <p class="topless"><a href="tags.html"
                              title="next chapter">Tags</a></p>
        <div id="searchbox" style="display: none">
            <h3>Search</h3>

            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18"/>
                <input type="submit" value="Go"/>
                <input type="hidden" name="check_keywords" value="yes"/>
                <input type="hidden" name="area" value="default"/>
            </form>
        </div>
        <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
        <div class="span9 contents">
            <div class="breadcrumb">
<div class="related">
    <h3>Navigation</h3>
    <ul>
        <li class="right" style="margin-right: 10px; margin-top: 6px;">
            <a href="../genindex.html" title="General Index" accesskey="I">
                index
            </a>
        </li>
        <li class="right" style="margin-right: 10px; margin-top: 6px;">
            <a href="tags.html" title="Tags" accesskey="N">
                next
            </a> |
        </li>
        <li class="right" style="margin-right: 10px; margin-top: 6px;">
            <a href="qa.html" title="Quality Assurance" accesskey="P">
                previous
            </a> |
        </li>
        <li>
            <a href="http://www.phpdoc.org">Homepage</a>  &raquo;
        </li>
        <li>
            <a href="../index.html">Documentation</a>  &raquo;
        </li>
        <li>
            <a href="index.html" accesskey="U">
                Internals
            </a>  &raquo;
        </li> 
    </ul>
</div>
            </div>

            
            <div class="well">
            

            
  <div class="section" id="application-flow">
<h1>Application Flow<a class="headerlink" href="#application-flow" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Generating the documentation for a project involves a fair number of steps but can be best summarized with the following
Activity Diagram:</p>
<p class="plantuml">
<img src="../_images/plantuml-149fd6dc8e828db9a71b3d06ab078646edc90246.png" alt="skinparam activityBorderColor #516f42
skinparam activityBackgroundColor #a3dc7f
skinparam shadowing false

start

:Boot the application;

:Parse files into an AST;

:Transform AST into artifacts;

stop" />
</p>
<p>This three step process enables phpDocumentor to break down a project into its most basic components, called Structural
Elements, and depending on which template was selected generate various types of output.</p>
<p>An example of such output may be a website that documents the project&#8217;s internal API. Another example could be a
checkstyle XML document that describes which errors in the project&#8217;s DocBlocks were found. Anything is possible.</p>
<p>In this document I provide an overview of all moving parts in the application but do not explain each technical
term in-depth. At the end of this document are reading suggestions but I recommend having the <a class="reference internal" href="../glossary.html"><em>用語集</em></a>
within reach.</p>
</div>
<div class="section" id="the-flow-in-more-detail">
<h2>The flow in more detail<a class="headerlink" href="#the-flow-in-more-detail" title="Permalink to this headline">¶</a></h2>
<p>The complete application flow is perhaps best described with the Activity Diagram below. It should cover most of the
large activities that occur in the application, including when and which events are emitted. This Activity Diagram does
not include detailed activities such as logging or translating.</p>
<p>Another thing to note is that the impact of Service Providers is not visible in this flow. That is not because Service
Providers don&#8217;t have their effect but because Service Providers blend in with the complete application flow and are
mainly used to add writers, filters validators and other components that can are automatically used during the
transformation process.</p>
<p>In the subchapters I will provide more detail on the individual sections and show the activities that are collapsed in
this diagram (such as <em>Boot the application</em>, <em>Add File Representation to Project</em> and other activities that are
surrounded by an additional border)</p>
<p class="plantuml">
<img src="../_images/plantuml-03c8ae9a363751e01c72865c48f4682cfaa163ab.png" alt="skinparam activityBorderColor #516f42
skinparam activityBackgroundColor #a3dc7f
skinparam shadowing false

start

:Boot the application|

partition &quot;Parse files into an AST&quot; {
    :Set parsing parameters;
    :Find project files;
    :Remove stale items from Descriptor Cache;
    :Load Descriptor Cache;

    while (There are unprocessed files?) is (Yes)
        if (File is cached) then (No)
            :Add File Representation to Project|
        else (Yes)
            :Load Cached File;
        endif;
    endwhile (No);

    :Write partial texts to Project;
    :Save Cache to Disk;
}

partition &quot;Transform AST into artifacts&quot; {
    :Load Cache From Disk;
    :Load Templates;
    :Load Transformations from Templates;

    while (For each Compiler Pass)
            if (Pass is &quot;Transformer&quot;)
                :Transform all files|
            elseif (Pass is &quot;Linker&quot;)
                :Link FQSENs to Descriptors|
            else
              :Execute compiler pass specific behaviour;
            endif;
    endwhile;

}

stop" />
</p>
<div class="section" id="boot-the-application">
<h3>Boot the Application<a class="headerlink" href="#boot-the-application" title="Permalink to this headline">¶</a></h3>
<p class="plantuml">
<img src="../_images/plantuml-5201683aea2b998db4e5cb3755366a21ee6e3a80.png" alt="skinparam activityBorderColor #516f42
skinparam activityBackgroundColor #a3dc7f
skinparam shadowing false

:Initialize dependencies using Application;
:Load configuration;
:Add logging;
:Register phpDocumentor's Service Providers;
:Load Third-Party Service Providers (plugins);" />
</p>
</div>
<div class="section" id="parse-files-into-an-ast">
<h3>Parse files into an AST<a class="headerlink" href="#parse-files-into-an-ast" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The following Activity Diagram below is an excerpt from the Diagram at the beginning of the chapter and is repeated
to support the text.</p>
</div>
<p class="plantuml">
<img src="../_images/plantuml-160a6f9f65e5751f15fbaf7c245349b93c7cc0bc.png" alt="skinparam activityBorderColor #516f42
skinparam activityBackgroundColor #a3dc7f
skinparam shadowing false

:Set parsing parameters;
:Find project files;
:Load Descriptor Cache;
:Remove stale items from Descriptor Cache;

while (There are unprocessed files?) is (Yes)
    if (File is cached and cache is valid) then (Yes)
        :Load Cached File;
    else (No)
        :Add File Representation to Project|
    endif;
endwhile (No);

:Write partial texts to Project;
:Save Cache to Disk;" />
</p>
<p>In order to be able to properly generate documentation phpDocumentor needs to find all files in the project that you
would want to document. There are several properties that influence which files are eligible for your documentation
based on provided parameters and options, such as directories and a listing describing which files are ignored.</p>
<p>If the given target folder contains a cache of a previous run of phpDocumentor then this is loaded. phpDocumentor
will remove all files from that cache that are not present in the file listing that was found earlier so that it doesn&#8217;t
contain any entries that are not intended to be documented.</p>
<p>Once that is done phpDocumentor should have a description of your Project, represented by an instance of the
ProjectDescriptor class, that may be pre-populated with the <a class="reference internal" href="../glossary.html#term-abstract-syntax-tree"><em class="xref std std-term">Abstract Syntax Tree</em></a> (other Descriptors) that were
discovered during a previous run.</p>
<p>When phpDocumentor is ready to create, or actually refresh, the <a class="reference internal" href="../glossary.html#term-ast"><em class="xref std std-term">AST</em></a> it will iterate over all files that were
discovered. A hash is generated of each file and checked with the cache if this file is still <em>fresh</em>. Should the hash
not exist in the Cache or it differs for a given file then phpDocumentor will create a new representation of that file
and overwrite the previous one.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>At this stage all links between elements, such as that of an <tt class="docutils literal"><span class="pre">&#64;see</span></tt> tag, are still strings containing the
<a class="reference internal" href="../glossary.html#term-fqsen"><em class="xref std std-term">FQSEN</em></a> that references another element. It is not until much later, in the Linker, where the text references
are converted into actual references to other objects.</p>
<p>This is done because:</p>
<ul class="last simple">
<li>caching references to objects can easily disconnect the two objects</li>
<li>if a file is refreshed then all links are lost and should be re-made</li>
<li>filtering and alterations may be done at later stages and actual references may become stale or new ones should
be made.</li>
</ul>
</div>
<div class="section" id="add-file-representation-to-project">
<h4>Add File Representation to Project<a class="headerlink" href="#add-file-representation-to-project" title="Permalink to this headline">¶</a></h4>
<p class="plantuml">
<img src="../_images/plantuml-2b279846abbc4b3402c5884eb61f8c0b00a68fc8.png" alt="skinparam activityBorderColor #516f42
skinparam activityBackgroundColor #a3dc7f
skinparam shadowing false

start

:Reflect file;
:Create File representation as FileDescriptor;

while (For each Structural Element in File)
    :Map reflected information onto new Descriptor;
    :Filter Descriptor;
    :Validate Descriptor;
    :Add Element Descriptor to File;
endwhile;

:Add File representation to Project;

stop" />
</p>
</div>
</div>
<div class="section" id="transform-ast-into-artifacts">
<h3>Transform AST into artifacts<a class="headerlink" href="#transform-ast-into-artifacts" title="Permalink to this headline">¶</a></h3>
<div class="section" id="transform-all-files">
<h4>Transform all files<a class="headerlink" href="#transform-all-files" title="Permalink to this headline">¶</a></h4>
<p class="plantuml">
<img src="../_images/plantuml-e3ff6ead5693bbfbf82e0740fb03870990e1ca91.png" alt="skinparam activityBorderColor #516f42
skinparam activityBackgroundColor #a3dc7f
skinparam shadowing false

start

#f9f9f9:Emit event &quot;transformer.transform.pre&quot;&gt;
#f9f9f9:Emit event &quot;transformer.writer.initialization.pre&quot;&gt;
:Boot involved writers;
#f9f9f9:Emit event &quot;transformer.writer.initialization.post&quot;&gt;

while (For each Transformation)
    #f9f9f9:Emit event &quot;transformer.transformation.pre&quot;&gt;
    :Execute associated Writer and pass Transformation;
    #f9f9f9:Emit event &quot;transformer.transformation.pre&quot;&gt;
endwhile;

#f9f9f9:Emit event &quot;transformer.transform.post&quot;&gt;

stop" />
</p>
</div>
</div>
<div class="section" id="link-fqsens-to-descriptors">
<h3>Link FQSENs to Descriptors<a class="headerlink" href="#link-fqsens-to-descriptors" title="Permalink to this headline">¶</a></h3>
<p class="plantuml">
<img src="../_images/plantuml-0ea800f0c55c22e3cd3576c0a728b20b44b2ad53.png" alt="skinparam activityBorderColor #516f42
skinparam activityBackgroundColor #a3dc7f
skinparam shadowing false

start

stop" />
</p>
</div>
</div>
</div>



            
            </div>
            
        </div>
    </div>

  <div class="row">
    <footer class="span12">
        <p>
            Created using <a
                href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.
        </p>
    </footer>
  </div>
</div>

</body>
</html>